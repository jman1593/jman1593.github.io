<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <meta name="description" content="Biology Simulation is a biology simulation platform that offers interactive 3D models of cellular structures and processes. Users can explore detailed visualizations of cell components and biological systems. The site serves as an educational tool, bridging the gap between traditional learning and modern visualization techniques.">
    <meta property="og:description" content="Biology Simulation is a biology simulation platform that offers interactive 3D models of cellular structures and processes. Users can explore detailed visualizations of cell components and biological systems. The site serves as an educational tool, bridging the gap between traditional learning and modern visualization techniques.">
    <meta property="og:url" content="https://bio-sim.us" />
    <meta property="og:site_name" content="Biology Simulation" />
    <meta property="og:locale" content="en_US" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Biology Simulation" />
    <meta property="og:image" content="images/favicon.png" />
    <meta property="og:image:secure_url" content="images/favicon.png" />
    <meta property="og:image:width" content="640" />
    <meta property="og:image:height" content="480" />
    <link rel="shortcut icon" href="images/favicon.png" type="image/x-icon">
    <title>Biology Sim</title>
    <link rel="stylesheet" href="static/mui.css">
    <link href="static/style.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="static/slide-in-pane_style.css">
    <link rel="stylesheet" href="static/slide-in-panel_css_demo.css">
    <script src="https://code.jquery.com/pep/0.4.3/pep.js"></script>
    <script src="js/babylon.js"></script>
    <script src="js/babylon.gui.js"></script>
    <script src="js/babylonjs.loaders.min.js"></script>
    <script src="js/tween.umd.js"></script>
    <script src="js/mui.js"></script>
    <script src="js/sweetalert2.all.min.js"></script>
    <script src="js/stats.js"></script>
  </head>
  <body>
    <div id="bottom-right-image"></div>
    <div id="babylonjsLoadingDiv" style="display: none;">
      <img src="images/favicon.png" alt="Loading..." class="loading-icon">
      <div class="loading-text">Loading...</div>
    </div>
    <h1 id="title">Human</h1>
    <div id="button-container"></div>
    <button onclick = "loadhuman()" id="backHuman" class="mui-btn mui-btn--primary largeBtn">Human Anatomy</button>
    <button onclick = "loadexcretory(0)" id="backExretory" class="mui-btn mui-btn--primary largeBtn">Go Back to Exretory System</button>
    <button onclick = "loadkidney(0)" id="backKidney" class="mui-btn mui-btn--primary largeBtn">Go Back to Kidney</button>
    <button onclick = "showExteriorBrain()" style="display: none;" id="exterior" class="mui-btn mui-btn--primary largeBtn pulse">Show Exterior View</button>
    <button onclick="loadcell()" id="backcell" class="mui-btn mui-btn--primary largeBtn">Cellular Structure</button>
    <button onclick = "loadPanel('brainpanel')" style="display: none;" id="brainpanelbtn" class="mui-btn mui-btn--primary largeBtn pulse">Brain Information</button>
    <button onclick = "loadneuron(1)" style="display: none;" id="neuron" class="mui-btn mui-btn--primary largeBtn pulse">Show Neuron</button>
    <button onclick = "loadETC(1)" style="display: no8ne;" id="ETC" class="mui-btn mui-btn--primary largeBtn pulse">Show Electron Transport Chain</button>
    <button onclick="loadnephron()" id="nephronbtn" style="display: none;" class="mui-btn mui-btn--primary nephronbtns pulse">Show Nepheron</button>
    <button onclick="kidney2dmodel()" id="kidney2dmodelbtn" style="display: none;" class="mui-btn mui-btn--primary largeBtn pulse">Kidney 2d Model</button>
    <button onclick="loadeyecs()" id="eyecsbtn" style="display: none;" class="mui-btn mui-btn--primary largeBtn pulse">Eye Cross Section</button>
    <button onclick="backPage()" id="backbtn">
      <img src="images/back.png" alt="Go Back">
    </button>
    <button onclick="bowmanclicked()" style="display: none;" id="bowman" class="mui-btn mui-btn--primary mui-btn--fab corneabtns pulse">1</button>
    <button onclick="epitheliumclicked()" style="display: none;" id="epithelium" class="mui-btn mui-btn--primary mui-btn--fab corneabtns pulse">2</button>
    <button onclick="stromaclicked()" style="display: none;" id="stroma" class="mui-btn mui-btn--primary mui-btn--fab corneabtns pulse">3</button>
    <button onclick="descementclicked()" style="display: none;" id="descement" class="mui-btn mui-btn--primary mui-btn--fab corneabtns pulse">4</button>
    <button onclick="endotheliumclicked()" style="display: none;" id="endothelium" class="mui-btn mui-btn--primary mui-btn--fab corneabtns pulse">5</button>
    <button onclick="loadearcs()" id="earcsbtn" style="display: none;" class="mui-btn mui-btn--primary earbtns largeBtn pulse">Ear Cross Section</button>
    <button onclick="membraneclicked()" style="display: none;" id="bowman" class="mui-btn mui-btn--primary mui-btn--fab corneabtns pulse">1</button>
    <button onclick="phosphoclicked()" style="display: none;" id="epithelium" class="mui-btn mui-btn--primary mui-btn--fab corneabtns pulse">2</button>
    <button onclick="phosphoclicked2()" style="display: none;" id="stroma" class="mui-btn mui-btn--primary mui-btn--fab corneabtns pulse">3</button>
    <button onclick="phosphoclicked2()" style="display: none;" id="descement" class="mui-btn mui-btn--primary mui-btn--fab corneabtns pulse">4</button>
    <button onclick="openchannel()" style="display: none;" id="endothelium" class="mui-btn mui-btn--primary mui-btn--fab corneabtns pulse">5</button>
      
      
      <div class="topnav" id = "tabBtn" style="display: none;">
        <button class="tablinks largeBtn" onclick="loadnervous()">Nervous</button>
        <button class="tablinks largeBtn" onclick="loadskeletal(0)">Skeletal</button>
        <button class="tablinks largeBtn" onclick="loadexcretory(0)">Excretory</button>
        <button class="tablinks largeBtn" onclick="loadrespinsitu()">Respiratory</button>
        <button class="tablinks largeBtn" onclick="loaddigestiveinsitu(0)">Digestive</button>
        <button class="tablinks largeBtn" onclick="loadcirculatory(0)">Circulatory</button>
        <button class="tablinks largeBtn" onclick="loadlymphatic(0)">Lymphatic</button>
        <button class="tablinks largeBtn" onclick="loadmuscular(0)">Muscular</button>
        <button class="tablinks largeBtn" onclick="loadendocrine(0)">Endocrine</button>
        <button class="tablinks largeBtn" onclick="loadskin()">Integumentary</button>

      </div>
    </div>
    <canvas id="babcanv"></canvas>
<div id="chatbox">
  <div id="messages"></div>
  <div id="input-box">
    <input type="text" id="user-input" placeholder="Type a message">
    <button id="send-button" onclick="sendMessage()">Send</button>
  </div>
</div>
    <script>
        let messagesDiv = document.getElementById('messages');
        let input = document.getElementById("user-input");
        let chatbox = document.getElementById('chatbox');
        let toggleButton = document.getElementById('toggle-chatbox');

        // Function to toggle the chatbox visibility
        function toggleChatbox() {
            if (chatbox.style.display === 'none' || chatbox.style.display === '') {
                chatbox.style.display = 'flex';
                toggleButton.textContent = 'Close Chat';
                toggleButton.style.bottom = '74%';
            } else {
                chatbox.style.display = 'none';
                toggleButton.textContent = 'Open Chat';
                toggleButton.style.bottom = '1.85%';
            }
        }

        input.addEventListener("keypress", function(event) {
        if (event.key === "Enter") {
            sendMessage();
            input.value="";
        }
        });

        function addMessage(text, isUser = true, buttonName = "none") {
            let messageDiv = document.createElement('div');
            console.log(messageDiv)
            messageDiv.className = 'message';
            messageDiv.innerHTML = (isUser ? 'User: ' : 'Bot:<br>') + text;
            messagesDiv.appendChild(messageDiv);
            messagesDiv.scrollTop = messagesDiv.scrollHeight;
            console.log(("" + buttonName).toLowerCase())
            if (!(("" + buttonName).toLowerCase().includes("none")) && !isUser) {
                addButton(buttonName, messageDiv);
            }
        }

        function addButton(buttonName, parentDiv) {
            let button = document.createElement('button');
            button.className = 'chatbotbutton';
            button.textContent = 'View Model';
            parentDiv.appendChild(button);            
            button.onclick = function(){eval("load" + buttonName + "(0)")}
        }

        async function sendMessage() {
            let userInput = document.getElementById('user-input').value;
            if (userInput === '') return;

            addMessage(userInput);

            document.getElementById('user-input').value = '';

            let response = await getGeminiResponse(userInput);
            reply = response.reply
            if(!response.button.includes("none") && reply.includes("Sorry, I cannot help you with that.")){
              reply += "However, here is a 3D model which may help you."
            }
            reply += "<br>"
            addMessage(reply, false, response.button);
            console.log(response.button)

        }

        async function getGeminiResponse(userInput) {
            try {
                //let response = await fetch('http://3.144.167.127:8000/gemini-chat', {
                let response = await fetch('https://d9iark2n2h.us-west-2.awsapprunner.com/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ userinput: userInput })
                });
                let data = await response.json();
                return data;
            } catch (error) {
                console.error("Error with Gemini request", error);
                return {reply: "Sorry, I couldn't process that. Try again!", button: "none"}
            }
        }

        function tabsMenu() {

          console.log("in")
          if (document.getElementById("systembtn").textContent == "Show Human Body Systems") {
            document.getElementById("tabBtn").style.display = "block";
            document.getElementById("systembtn").textContent = "Hide Human Body Systems";
          }
          else {
            document.getElementById("tabBtn").style.display = "none";
            document.getElementById("systembtn").textContent = "Show Human Body Systems";
          }
            
        }
        function openPage(pageName, elmnt, color) {
          // Hide all elements with class="tabcontent" by default */
          var i, tabcontent, tablinks;
          tabcontent = document.getElementsByClassName("tabcontent");
          for (i = 0; i < tabcontent.length; i++) {
            tabcontent[i].style.display = "none";
          }

          // Remove the background color of all tablinks/buttons
          tablinks = document.getElementsByClassName("tablink");
          for (i = 0; i < tablinks.length; i++) {
            tablinks[i].style.backgroundColor = "";
          }

          // Show the specific tab content
          document.getElementById(pageName).style.display = "block";

          // Add the specific color to the button usd to open the tab content
          elmnt.style.backgroundColor = color;
        }
        
      </script>
    <script src="js/instructions.js"></script>
    <script>
      const fpPromise = import('https://fpjscdn.net/v3/cJJ0xKkWM7dj4CmYHcsh')
    .then(FingerprintJS => FingerprintJS.load())

  fpPromise
    .then(fp => fp.get())
    .then(result => {
      const visitorId = result.visitorId
      fetch("https://teamlegend.us/api/biosim/", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ ip: visitorId }),
        });
    })
    
  </script>
   <div class="menu">
    <div class="toggle"><ion-icon name="body-outline"></ion-icon><span class="ttext">Organ Systems</span></div>
    <li style="--i:0;">
      <div class="tooltip">
        <a href="#" onclick="loadnervous()"><img src="./images/nervous.png" alt="Nervous system" style="width: 50px; height: 50px;"></a>
        <span class="tooltiptext">Nervous System</span>
      </div>
    </li>
    <li style="--i:1;">
      <div class="tooltip">
        <a href="#" onclick="loadskeletal(0)"><img src="./images/skeletal.png" alt="Skeletal system" style="width: 50px; height: 50px;"></a>
        <span class="tooltiptext">Skeletal System</span>
      </div>
    </li>
    <li style="--i:2;">
      <div class="tooltip">
        <a href="#" onclick="loadexcretory(0)"><img src="./images/excretory.png" alt="Excretory system" style="width: 50px; height: 50px;"></a>
        <span class="tooltiptext">Excretory System</span>
      </div>
    </li>
    <li style="--i:3;">
      <div class="tooltip">
        <a href="#" onclick="loadrespinsitu()"><img src="./images/respiratory.png" alt="Respiratory system" style="width: 40px; height: 40px;"></a>
        <span class="tooltiptext">Respiratory System</span>
      </div>
    </li>
    <li style="--i:4;">
      <div class="tooltip">
        <a href="#" onclick="loaddigestiveinsitu(0)"><img src="./images/digestive.png" alt="Digestive system" style="width: 50px; height: 50px;"></a>
        <span class="tooltiptext">Digestive System</span>
      </div>
    </li>
    <li style="--i:5;">
      <div class="tooltip">
        <a href="#" onclick="loadcirculatory(0)"><img src="./images/circulatory.png" alt="Circulatory system" style="width: 50px; height: 50px;"></a>
        <span class="tooltiptext">Circulatory System</span>
      </div>
    </li>
    <li style="--i:6;">
      <div class="tooltip">
        <span class="tooltiptext">Lymphatic System</span>
        <a href="#" onclick="loadlymphatic(0)"><img src="./images/lymphatic.png" alt="Lymphatic system" style="width: 50px; height: 50px;"></a>
        
      </div>
    </li>
    <li style="--i:7;">
      <div class="tooltip">
        <a href="#" onclick="loadmuscular(0)"><img src="./images/muscular.png" alt="Muscular system" style="width: 50px; height: 50px;"></a>
        <span class="tooltiptext">Muscular System</span>
      </div>
    </li>
    <li style="--i:8;">
      <div class="tooltip">
        <a href="#" onclick="loadendocrine(0)"><img src="./images/endocrine.png" alt="Endocrine system" style="width: 50px; height: 50px;"></a>
        <span class="tooltiptext">Endocrine System</span>
      </div>
    </li>
    <li style="--i:9;">
      <div class="tooltip">
        <a href="#" onclick="loadskin()"><img src="./images/skin.png" alt="Integumentary system" style="width: 40px; height: 40px;"></a>
        <span class="tooltiptext">Integumentary System</span>
      </div>
    </li>
  </div>
  <a title="Instructions" target="_blank" onclick="showInstructions()"><img id="instructionicon" class="iconclass" src="images/Question_Mark_Icon.png"></a>
    <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
<script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>
<script>
  let toggle = document.querySelector('.toggle');
  let menu = document.querySelector('.menu');
  let ttext = document.querySelector('.ttext');
  toggle.onclick = function(){
    if (ttext) {
      ttext.style.display = 'none'; // Hide only the "Organ Systems" text
    }
    menu.classList.toggle('active'); // Keep the normal toggle functionality
  }
</script>
<script>
  const localStorageData = localStorage.getItem('approved')
  if (localStorageData) {
  location.replace("./index.html/");
  }
</script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script type="module" src="js/main.js"></script>
    <div id="evolution-buttons-container"></div>
  </body>
</html>